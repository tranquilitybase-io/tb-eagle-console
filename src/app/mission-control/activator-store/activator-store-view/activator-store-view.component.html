<header class="activ-sub-header">
  <div class="header-left">
    <app-breadcrumbs *ngIf="!(isSelectedSolution$ | async); else solutionSelectedBreadcrmbs" [title]="activator.name">
    </app-breadcrumbs>
    <ng-template #solutionSelectedBreadcrmbs>
      <app-breadcrumbs
        [steps]="[
          {
            name: 'Solutions',
            link: '/mission-control/solutions'
          },
          {
            name: (selectedSolution$ | async).name,
            link: '/mission-control/solutions/view',
            id: (selectedSolution$ | async).id
          },
          {
            name: 'Provision new activator',
            link: '/mission-control/activator-store'
          },
          {
            name: 'Activator Store',
            link: '/mission-control/activator-store'
          },
          {
            name: selectedActivatorName
          }
        ]"
        [visibleBreadcrumbsStartIndex]="2"
      ></app-breadcrumbs>
    </ng-template>
    <p
      *ngIf="activator.status"
      class="badge status-badge"
      [class.primary]="activator.status === 'Locked'"
      [class.red]="activator.status === 'Deprecated'"
    >
      {{ activator.status }}
    </p>
  </div>
  <div class="flex-group">
    <button
      mat-raised-button
      color="primary"
      *ngIf="isLocked && !(userIsAdmin$ | async)"
      (click)="requestAccess()"
      class="button-policy"
    >
      Request Access
    </button>
    <button
      mat-raised-button
      color="primary"
      *ngIf="isLocked && (userIsAdmin$ | async)"
      (click)="grantAccess()"
      class="button-policy"
    >
      Grant Access
    </button>
    <button
      mat-raised-button
      color="primary"
      *ngIf="isAvailable && (userIsAdmin$ | async)"
      (click)="setLocked()"
      class="button-policy"
    >
      Lock
    </button>
    <button
      mat-raised-button
      color="primary"
      *ngIf="(isAvailable || isLocked) && (userIsAdmin$ | async)"
      (click)="setDeprecated()"
      class="button-policy"
    >
      Deprecate
    </button>
    <button
      mat-raised-button
      color="primary"
      *ngIf="isDeprecated && (userIsAdmin$ | async)"
      (click)="setLocked()"
      class="button-policy"
    >
      Undeprecate
    </button>
  </div>
</header>
<mat-tab-group mat-stretch-tabs>
  <mat-tab label="Overview">
    <app-activator-store-view-overview></app-activator-store-view-overview>
  </mat-tab>
  <mat-tab label="Deployments">
    <app-applications-deployments></app-applications-deployments>
  </mat-tab>
  <mat-tab label="Audit history">
    <app-activator-store-view-audit-history></app-activator-store-view-audit-history>
  </mat-tab>
  <mat-tab label="Version history">
    <app-activator-store-view-version-history></app-activator-store-view-version-history>
  </mat-tab>
  <mat-tab label="Users">
    <app-activator-store-view-users></app-activator-store-view-users>
  </mat-tab>
  <mat-tab label="Billing">
    <app-activator-store-view-billing></app-activator-store-view-billing>
  </mat-tab>
</mat-tab-group>

<div *ngIf="!(userIsAdmin$ | async)">
  <div class="app-bottom-action right">
    <a
      mat-button
      color="primary"
      routerLink="/mission-control/activator-store/create-app"
      queryParamsHandling="preserve"
    >
      Add to Solution
      <mat-icon>chevron_right</mat-icon>
    </a>
  </div>
  <div class="app-bottom-background"></div>
</div>
